{% extends 'gestion/base.html' %}
{% block title %}Ver Archivo{% endblock %}

<div id="main-content">

{% block content %}
<h2>Visualizaci√≥n del archivo</h2>

<a href="{% url 'archivo_list' %}">‚¨ÖÔ∏è Volver al listado</a>

<div style="margin-top: 20px;">
  {% if archivo.archivo %}
    {% if archivo.extension == "pdf" %}
        <embed src="{{ archivo.archivo.url }}" width="100%" height="600px" type="application/pdf"/>

    {% elif archivo.extension == "mp4" %}
        <video width="100%" height="auto" controls>
            <source src="{{ archivo.archivo.url }}" type="video/mp4">
            Tu navegador no soporta videos HTML5.
        </video>

    {% elif archivo.extension == "txt" %}
        <iframe src="{{ archivo.archivo.url }}" width="100%" height="600px" style="border: 1px solid #ccc;"></iframe>

    {% elif archivo.extension in "jpg jpeg png" %}
        <img src="{{ archivo.archivo.url }}" alt="Imagen" style="max-width: 100%; height: auto;"/>

    {% elif archivo.extension in "ppt pptx pps ppsx doc docx" %}
        <!-- Mostrar con Office Viewer -->
        <iframe src="{{ enlace_modificado }}" width="100%" height="600px" frameborder="0"></iframe>

    {% else %}
        <p>Archivo descargable: <a href="{{ archivo.archivo.url }}" download>üì§ Descargar</a></p>
    {% endif %}

  {% elif archivo.enlace_externo %}
    <h3>üîó Contenido externo</h3>

    {% if "youtube.com" in archivo.enlace_externo or "youtu.be" in archivo.enlace_externo %}
        <!-- YouTube -->
        <iframe width="100%" height="500px"
            src="https://www.youtube.com/embed/{{ archivo.enlace_externo|cut:'https://youtu.be/'|cut:'https://www.youtube.com/watch?v=' }}"
            frameborder="0" allowfullscreen>
        </iframe>

    {% elif "drive.google.com" in archivo.enlace_externo %}
        <!-- Google Drive: Mostrar enlace si hay error -->
        <p>Si el contenido no se carga correctamente, haz clic aqu√≠:</p>
        <a href="{{ archivo.enlace_externo }}" target="_blank">üìÑ Ver archivo en Google Drive</a>
        <iframe src="{{ enlace_modificado }}" width="100%" height="600px" allow="autoplay"></iframe>

    {% elif enlace_modificado %}
        <!-- Office Online Viewer u otros -->
        <iframe src="{{ enlace_modificado }}" width="100%" height="600px" frameborder="0"></iframe>

    {% else %}
        <p><a href="{{ archivo.enlace_externo }}" target="_blank">üìÑ Abrir enlace externo</a></p>
    {% endif %}

  {% else %}
    <p>‚ö†Ô∏è No hay archivo disponible.</p>
  {% endif %}
</div>
{% endblock %}
</div>
